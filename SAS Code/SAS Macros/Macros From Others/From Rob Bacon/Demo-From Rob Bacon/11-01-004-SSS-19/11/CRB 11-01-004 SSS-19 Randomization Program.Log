NOTE: Copyright (c) 2002-2008 by SAS Institute Inc., Cary, NC, USA.
NOTE: SAS (r) Proprietary Software 9.2 (TS2M0)
      Licensed to THE PROCTER & GAMBEL CO/POWER USER BUNDLE, Site 70075584.
NOTE: This session is executing on the XP_PRO  platform.



WARNING: Your system is scheduled to expire on February 28, 2011, which is 33 days from
         now. The SAS System will no longer function on or after that date. Please
         contact your SAS Installation Representative to obtain your updated SAS
         Installation Data (SID) file, which includes SETINIT information.
To locate the name of your SAS Installation Representative go to
http://support.sas.com/repfinder and provide your site number 70075584 and company name
as THE PROCTER & GAMBEL CO/POWER USER BUNDLE. On the SAS REP list provided, locate the
REP for operating system Windows.
NOTE: SAS initialization used:
      real time           21.74 seconds
      cpu time            1.85 seconds

WARNING: The Base Product product with which Session Manager is associated
WARNING: will be expiring soon, and is currently in warning mode to indicate
WARNING: this upcoming expiration. Most typically this warning period runs
WARNING: for 45 days. Please run PROC SETINIT to obtain more information on
WARNING: your warning period.
1    ************************************************************************************
1  ! ******
2        FILE    : Randomization for Split Scalp Studies.sas
3        CREATED : 12/14/01
4        UPDATED : 1/10/11
5        VERSION : 1.3
6    ************************************************************************************
6  ! ******
7
8       The following program creates a randomization for the split scalp studies.
9       This program works for 1-4 treatment pairs.  If more treatment pairs are
9  ! necessary make
10       adjustments where marked within the program.
11      It will create three randomization files (SAS Data Set, Txt File, and Word
11 ! Document).
12      In order to make the Word Document fit in landscape, change Page Setup to
12 ! landscape
13       within SAS.
14
15   ************************************************************************************
15 ! ******
16          ONLY MAKE CHANGES BETWEEN THE TWO LINES OF STARS THAT FOLLOW
17   ************************************************************************************
17 ! ******;
18
19   %LET STUDY=CRB 11-01-004 SSS-19;    *Name of study CRB XX-XX-XXX;
20   %Let DIR=C:\Documents and Settings\ti4224\My Documents\My
20 ! Work\Crb\11-01-004-SSS-19\11\; *Directory that all files created are saved to;
21   %LET RAND=RAND1101004;          *Filename of randomization SAS Data Set;
22   %Let TXTBA=CRB1101001BA.Txt; *Filename of .Txt file;
23   %LET SEED=5478;             *4 digit random number - make different for each study;
24   %LET NUM=_N_+100;               *Defines lowest subject number - _N_=1 - For 101 use
24 !  _N_+100;
25   %LET BLOCKSIZE=4;           *Number of different treatment Sequences being used;
26
27   %LET BLOCKS=45;        *(# of subjects)/(BLOCKSIZE) rounded up to the next whole
27 ! number;
28
29   ************************************************************************************
29 ! *****************
30          ONLY MAKE CHANGES ABOVE THIS LINE, DO NOT MAKE CHANGES BELOW THIS LINE
31   ************************************************************************************
31 ! *****************;
32
33   proc format;
34   * One Treatment Pair Design - BLOCKSIZE=2;
35      value seqa    1=' A, B, 1'
36                    2=' B, A, 1'
37                    ;
NOTE: Format SEQA has been output.
38      value $spfa
39               'A'='A' 'B'='B';
NOTE: Format $SPFA has been output.
40
41   * Two Treatment Pair Design - BLOCKSIZE=4;
42      value seqb    1=' A, B, 1' 2=' B, A, 1'
43                    3=' C, D, 2' 4=' D, C, 2'
44                       ;
NOTE: Format SEQB has been output.
45      value $spfb
46               'A'='A' 'B'='B' 'C'='C' 'D'='D';
NOTE: Format $SPFB has been output.
47
48
49   * Three Treatment Pair Design - BLOCKSIZE=6;
50      value seqc    1=' A, B, 1' 2=' B, A, 1'
51                    3=' C, D, 2' 4=' D, C, 2'
52                    5=' E, F, 3' 6=' F, E, 3'
53                   ;
NOTE: Format SEQC has been output.
54      value $spfc
55               'A'='A' 'B'='B' 'C'='C' 'D'='D' 'E'='E' 'F'='F';
NOTE: Format $SPFC has been output.
56
57   * Four Treatment Pair Design - BLOCKSIZE=8;
58       value seqd   1=' A, B, 1' 2=' B, A, 1'
59                    3=' C, D, 2' 4=' D, C, 2'
60                    5=' E, F, 3' 6=' F, E, 3'
61                    7=' G, H, 4' 8=' H, G, 4'
62                    ;
NOTE: Format SEQD has been output.
63       value $spfd
64               'A'='A' 'B'='B' 'C'='C' 'D'='D' 'E'='E' 'F'='F' 'G'='G' 'H'='H';
NOTE: Format $SPFD has been output.
65
66
67       value $spfGroup
68           '1' = 1
69           '2' = 2
70           '3' = 3
71           '4' = 4
72           ;
NOTE: Format $SPFGROUP has been output.
73   *If more than four treatment pairs are necessary add a value seqe & $spfe here.;
74
75   options nodate nonumber;
76   Libname SAVE "&DIR";
NOTE: Libref SAVE was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\Documents and Settings\ti4224\My Documents\My
      Work\Crb\11-01-004-SSS-19\11
77   TITLE1 "&STUDY Randomization";
78   FILENAME F_txtba "&DIR.&TXTBA";
79   footnote1 ' ';
80

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.20 seconds
      cpu time            0.00 seconds


81   proc plan seed=&seed;
WARNING: The SAS/STAT product with which PLAN is associated will be expiring soon, and
         is currently in warning mode to indicate this upcoming expiration. Most
         typically this warning period runs for 45 days. Please run PROC SETINIT to
         obtain more information on your warning period.
NOTE: At the start of processing, random number seed=5478.
82        output out=plan;
83        factors blocks=&blocks  ordered Sequence=&BLOCKSIZE of &BLOCKSIZE / noprint;
84   run;

NOTE: The data set WORK.PLAN has 180 observations and 2 variables.
85

NOTE: At the  end  of processing, random number seed=1556266705.
NOTE: PROCEDURE PLAN used (Total process time):
      real time           0.25 seconds
      cpu time            0.00 seconds


86   data test;
87       set plan;
88       keep RandNo Sequence Site01 - Site02 Group;
89       RandNo=&NUM;
90
91       if &BLOCKSIZE=2 then do;
92           Site01=put(scan(put(Sequence,seqa.),1),$spfa.);
93           Site02=put(scan(put(Sequence,seqa.),2),$spfa.);
94           Group=put(scan(put(Sequence,seqa.),3),spfGroup.);
95       end;
96       if &BLOCKSIZE=4 then do;
97           Site01=put(scan(put(Sequence,seqb.),1),$spfb.);
98           Site02=put(scan(put(Sequence,seqb.),2),$spfb.);
99           Group=put(scan(put(Sequence,seqb.),3),spfGroup.);
100      end;
101      if &BLOCKSIZE=6 then do;
102          Site01=put(scan(put(Sequence,seqc.),1),$spfc.);
103          Site02=put(scan(put(Sequence,seqc.),2),$spfc.);
104          Group=put(scan(put(Sequence,seqc.),3),spfGroup.);
105      end;
106      if &BLOCKSIZE=8 then do;
107          Site01=put(scan(put(Sequence,seqd.),1),$spfd.);
108          Site02=put(scan(put(Sequence,seqd.),2),$spfd.);
109          Group=put(scan(put(Sequence,seqd.),3),spfGroup.);
110      end;
111
112  *If more than 4 treatment pairs are necessary, add an "if...then do" here, similar
112! to above.;
113  run;

NOTE: There were 180 observations read from the data set WORK.PLAN.
NOTE: The data set WORK.TEST has 180 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.75 seconds
      cpu time            0.06 seconds


114
115  data clmba;
116      set test;
117
118      if Sequence=1 then ba_trt='A';
119      if Sequence=2 then ba_trt='B';
120      if Sequence=3 then ba_trt='C';
121      if Sequence=4 then ba_trt='D';
122      if Sequence=5 then ba_trt='E';
123      if Sequence=6 then ba_trt='F';
124      if Sequence=7 then ba_trt='G';
125      if Sequence=8 then ba_trt='H';
126
127      FILE F_TXTBA;
128            If   1<=RandNo<=9   then PUT #1 @3 RandNo @5 ba_trt;
129
130            If  10<=RandNo<=99  then PUT #1 @2 RandNo @5 ba_trt;
131
132            If 100<=RandNo<=999 then PUT #1 @1 RandNo @5 ba_trt;
133  run;

NOTE: The file F_TXTBA is:

      Filename=C:\Documents and Settings\ti4224\My Documents\My
      Work\Crb\11-01-004-SSS-19\11\CRB1101001BA.Txt,
      RECFM=V,LRECL=256,File Size (bytes)=0,
      Last Modified=26Jan2011:08:43:38,
      Create Time=10Jan2011:16:52:05

NOTE: 180 records were written to the file F_TXTBA.
      The minimum record length was 5.
      The maximum record length was 5.
NOTE: There were 180 observations read from the data set WORK.TEST.
NOTE: The data set WORK.CLMBA has 180 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.01 seconds


134
135  options leftmargin=1 rightmargin=1 topmargin=.5 bottommargin=.5 ;
WARNING: Units were not specified on the LEFTMARGIN option. Inches will be used.
WARNING: Units were not specified on the RIGHTMARGIN option. Inches will be used.
WARNING: Units were not specified on the TOPMARGIN option. Inches will be
         used.
WARNING: Units were not specified on the BOTTOMMARGIN option. Inches will be
         used.
136  options orientation=portrait;
137
138  proc template;
139      define style newstyle;
140        parent=styles.printer;
141        replace headersAndFooters from cell /
142           font = fonts('HeadingFont')
143           foreground = colors('headerfg')
144           background = white;
145      end;
NOTE: Overwriting existing template/link: Newstyle
NOTE: STYLE 'Newstyle' has been saved to: SASUSER.TEMPLAT
146  run;
NOTE: PROCEDURE TEMPLATE used (Total process time):
      real time           0.78 seconds
      cpu time            0.03 seconds


147
148  ODS RTF FILE="&DIR.&STUDY Randomization.doc"
149  style=newstyle;
NOTE: Writing RTF Body file: C:\Documents and Settings\ti4224\My
      Documents\My Work\Crb\11-01-004-SSS-19\11\CRB 11-01-004 SSS-19
      Randomization.doc
150
151  proc report nowd data=test headline headskip split='*' spacing=5;
152      column RandNo Sequence Site01 Site02;
153      define RandNo / order   center width=7 format=3. 'Product * Number';
154      define Sequence /display center width=8 format=2. 'Sequence';
155      define Site01  / display center width=12 format=$1. 'Trt Left Side '
155!  spacing=3;
156      define Site02  / display center width=12 format=$1. 'Trt Right Side'
156!  spacing=3;
157      break after RandNo / skip;
158  run;

NOTE: There were 180 observations read from the data set WORK.TEST.
NOTE: PROCEDURE REPORT used (Total process time):
      real time           2.07 seconds
      cpu time            0.21 seconds


159
160  ODS OUTPUT;
161  ODS LISTING;
162  ODS RTF CLOSE;
163  RUN;
164
165  data test;
166      set test;
167      Left=Site01;
168      Right=Site02;
169
170      drop Site01 Site02;
171  run;

NOTE: There were 180 observations read from the data set WORK.TEST.
NOTE: The data set WORK.TEST has 180 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds


172
173  PROC SORT DATA=test;
174      BY RandNo Sequence Group;
175  RUN;

NOTE: There were 180 observations read from the data set WORK.TEST.
NOTE: The data set WORK.TEST has 180 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.12 seconds
      cpu time            0.01 seconds


176
177  PROC TRANSPOSE DATA=test
178      OUT=Save.&Rand
179      NAME=Source
180      LABEL=Label;
181      BY RandNo Sequence Group;
182      VAR Left Right;
183  RUN;

NOTE: There were 180 observations read from the data set WORK.TEST.
NOTE: The data set SAVE.RAND1101004 has 360 observations and 5 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.06 seconds
      cpu time            0.01 seconds


184
185  data save.&rand;
186      set save.&rand;
187      Side=Source;
188      Trt=Col1;
189      drop Col1 Source;
190  run;

NOTE: There were 360 observations read from the data set SAVE.RAND1101004.
NOTE: The data set SAVE.RAND1101004 has 360 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds


191
192  Proc export data=Save.&Rand
193      outfile="&Dir/&Study. Rand.csv"
194      dbms=csv
195      replace;
196  Run;

197   /**********************************************************************
198   *   PRODUCT:   SAS
199   *   VERSION:   9.2
200   *   CREATOR:   External File Interface
201   *   DATE:      26JAN11
202   *   DESC:      Generated SAS Datastep Code
203   *   TEMPLATE SOURCE:  (None Specified.)
204   ***********************************************************************
204! /
205      data _null_;
206      %let _EFIERR_ = 0; /* set the ERROR detection macro variable */
207      %let _EFIREC_ = 0;     /* clear export record count macro variable
207! */
208      file 'C:\Documents and Settings\ti4224\My Documents\My
208! Work\Crb\11-01-004-SSS-19\11\/CRB 11-01-004 SSS-19 Rand.csv'
208! delimiter=',' DSD DROPOVER lrecl=32767;
209      if _n_ = 1 then        /* write column names or labels */
210       do;
211         put
212            "RandNo"
213         ','
214            "Sequence"
215         ','
216            "Group"
217         ','
218            "Side"
219         ','
220            "Trt"
221         ;
222       end;
223     set  SAVE.RAND1101004   end=EFIEOD;
224         format RandNo best12. ;
225         format Sequence best12. ;
226         format Group $1. ;
227         format Side $8. ;
228         format Trt $1. ;
229       do;
230         EFIOUT + 1;
231         put RandNo @;
232         put Sequence @;
233         put Group $ @;
234         put Side $ @;
235         put Trt $ ;
236         ;
237       end;
238      if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection
238! macro variable */
239      if EFIEOD then call symputx('_EFIREC_',EFIOUT);
240      run;

NOTE: The file 'C:\Documents and Settings\ti4224\My Documents\My
      Work\Crb\11-01-004-SSS-19\11\/CRB 11-01-004 SSS-19 Rand.csv' is:

      Filename=C:\Documents and Settings\ti4224\My Documents\My
      Work\Crb\11-01-004-SSS-19\11\\CRB 11-01-004 SSS-19 Rand.csv,
      RECFM=V,LRECL=32767,File Size (bytes)=0,
      Last Modified=26Jan2011:08:43:49,
      Create Time=26Jan2011:08:43:49

NOTE: 361 records were written to the file 'C:\Documents and
      Settings\ti4224\My Documents\My Work\Crb\11-01-004-SSS-19\11\/CRB
      11-01-004 SSS-19 Rand.csv'.
      The minimum record length was 14.
      The maximum record length was 30.
NOTE: There were 360 observations read from the data set SAVE.RAND1101004.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds


360 records created in C:\Documents and Settings\ti4224\My Documents\My
Work\Crb\11-01-004-SSS-19\11\/CRB 11-01-004 SSS-19 Rand.csv from
SAVE.RAND1101004.


NOTE: "C:\Documents and Settings\ti4224\My Documents\My
      Work\Crb\11-01-004-SSS-19\11\/CRB 11-01-004 SSS-19 Rand.csv" file was
      successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           5.23 seconds
      cpu time            0.50 seconds


241
242  /*
243  VERSION 1.1 - 7/22/03
244      The filenames of the randomization files were changed so that they
244! followed the
245      archiving principles for acceptable filenames.
246
247      The macro variable COMB was replaced with BLOCKSIZE for ease of
247! understanding
248
249      The DM Log statement was added to autmatically save the log to a
249! file called
250      CRB xx-xx-xxx Randomization Program.log.  This file is saved in the
250! directory
251      specified by the macro variable called DIR.
252
253      The formating of this program  was changed so that it could be
253! printed on a page
254      with its margins set to 0.5.
255
256  VERSION 1.2 - 4/9/09
257      The randomization program was customized to work with pair designs
257! where a placebo is
258      matched with an active treatment.  This template was customized for
258! the split scalp
259      studies.
260
261      The clm file for the B&A program was changed to deal with paired
261! designs
262
263      A Group variable was added to the randomization data set to identify
263!  the different
264      treatment pairs
265
